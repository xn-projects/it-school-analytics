2025-11-02 14:33:52,915 — [INFO] Logging started. File: logs/log_2025-11-02_14-33-52.txt
2025-11-02 14:33:52,922 — [INFO] Repository successfully loaded and ready
2025-11-02 14:33:52,950 — [INFO] ==================================================
2025-11-02 14:33:52,956 — [INFO] === Downloading source Excel files ===
2025-11-02 14:33:52,962 — [INFO] ==================================================
2025-11-02 14:33:53,289 — [INFO] File calls.xlsx downloaded to data/raw/calls.xlsx
2025-11-02 14:33:53,553 — [INFO] File contacts.xlsx downloaded to data/raw/contacts.xlsx
2025-11-02 14:33:53,834 — [INFO] File deals.xlsx downloaded to data/raw/deals.xlsx
2025-11-02 14:33:54,091 — [INFO] File spend.xlsx downloaded to data/raw/spend.xlsx
2025-11-02 14:33:54,093 — [INFO] Downloaded 4 files successfully.
2025-11-02 14:33:54,108 — [INFO] ==================================================
2025-11-02 14:33:54,111 — [INFO] === Reading Excel files ===
2025-11-02 14:33:54,113 — [INFO] ==================================================
2025-11-02 14:34:25,580 — [INFO] All files successfully loaded into DataFrames.
2025-11-02 14:34:25,587 — [INFO] ==================================================
2025-11-02 14:34:25,589 — [INFO] === Analyzing Calls dataset ===
2025-11-02 14:34:25,590 — [INFO] ==================================================
2025-11-02 14:34:26,027 — [INFO] Dropped irrelevant columns: Dialled Number, Tag.
2025-11-02 14:34:26,135 — [INFO] calls_raw: Found 6382 duplicate rows (checked 8 columns).
2025-11-02 14:34:26,312 — [INFO] calls_clean: 3257 duplicates removed (92617 rows left)
2025-11-02 14:34:26,729 — [INFO] Converted Call Start Time to datetime.
2025-11-02 14:34:26,759 — [INFO] Missing CONTACTID rows: 3802
2025-11-02 14:34:26,820 — [INFO] Removed 1292 rows with missing CONTACTID and Call duration = 0
2025-11-02 14:34:26,893 — [INFO] Filled missing Call Duration values with 0 and added Is_duration_missing flag.
2025-11-02 14:34:26,914 — [INFO] Missing Outgoing Call Status: 8051 rows
2025-11-02 14:34:26,931 — [INFO] Filled missing Outgoing Call Status with Unknown.
2025-11-02 14:34:26,943 — [INFO] Filled missing Scheduled in CRM with 0.0 and added boolean flag Is_schedule_missing.
2025-11-02 14:34:26,961 — [INFO] Converted Call Type to category.
2025-11-02 14:34:26,976 — [INFO] Converted Call Status to category.
2025-11-02 14:34:26,986 — [INFO] Converted Outgoing Call Status to category.
2025-11-02 14:34:27,220 — [INFO] Calls cleaning completed in 1.63 sec.
2025-11-02 14:34:27,227 — [INFO] ==================================================
2025-11-02 14:34:27,228 — [INFO] === Analyzing Contacts dataset ===
2025-11-02 14:34:27,230 — [INFO] ==================================================
2025-11-02 14:34:27,337 — [INFO] contacts_raw: Found 71 duplicate rows (checked 3 columns).
2025-11-02 14:34:27,372 — [INFO] contacts_clean: 38 duplicates removed (18510 rows left)
2025-11-02 14:34:27,405 — [INFO] Rows with True/False in Contact Owner Name: 1
2025-11-02 14:34:27,438 — [INFO] Removed invalid True/False Contact Owner Name values.
2025-11-02 14:34:27,516 — [INFO] Converted Created Time to datetime.
2025-11-02 14:34:27,582 — [INFO] Converted Modified Time to datetime.
2025-11-02 14:34:27,596 — [INFO] No rows where Created Time > Modified Time.
2025-11-02 14:34:27,678 — [INFO] Contacts cleaning completed in 0.45 sec.
2025-11-02 14:34:27,691 — [INFO] ==================================================
2025-11-02 14:34:27,693 — [INFO] === Analyzing Spend dataset ===
2025-11-02 14:34:27,694 — [INFO] ==================================================
2025-11-02 14:34:27,791 — [INFO] spend_raw: Found 1527 duplicate rows (checked 8 columns).
2025-11-02 14:34:27,831 — [INFO] spend_clean: 917 duplicates removed (19862 rows left)
2025-11-02 14:34:27,865 — [INFO] Found 262 test rows.
2025-11-02 14:34:27,884 — [INFO] Rows after removing test data: 19600
2025-11-02 14:34:27,898 — [INFO] Rows where 3 columns have 0: 3369
2025-11-02 14:34:27,909 — [INFO] Rows after removing zero rows: 16231
2025-11-02 14:34:27,927 — [INFO] Filled missing values in ['Campaign', 'AdGroup', 'Ad'] with Unknown.
2025-11-02 14:34:27,957 — [INFO] Cleaned and converted Ad — 0 values changed.
2025-11-02 14:34:27,972 — [INFO] Converted Source to category.
2025-11-02 14:34:28,036 — [INFO] Spend cleaning completed in 0.34 sec.
2025-11-02 14:34:28,043 — [INFO] ==================================================
2025-11-02 14:34:28,044 — [INFO] === Analyzing Deals dataset ===
2025-11-02 14:34:28,045 — [INFO] ==================================================
2025-11-02 14:34:32,912 — [INFO] Filled 791 missing values in City
2025-11-02 14:34:36,157 — [INFO] Filled 432 missing values in Level of Deutsch
2025-11-02 14:34:42,409 — [INFO] Filled 6 missing values in Deal Owner Name
2025-11-02 14:34:43,912 — [INFO] Filled 0 missing values in Course duration
2025-11-02 14:34:44,004 — [INFO] deals_raw: Found 18 duplicate rows (checked 22 columns).
2025-11-02 14:34:44,157 — [INFO] deals_clean: 9 duplicates removed (21586 rows left)
2025-11-02 14:34:44,226 — [INFO] Rows with Lost Reason = Duplicate: 1767
2025-11-02 14:34:44,249 — [INFO] Rows after removing Duplicate deals: 19819
2025-11-02 14:34:44,261 — [INFO] Test rows found: 156
2025-11-02 14:34:44,283 — [INFO] Rows after removing test rows: 19663
2025-11-02 14:34:44,296 — [INFO] Found 2 rows with missing Id.
2025-11-02 14:34:44,342 — [INFO] Rows after removing rows with missing Id: 19661
2025-11-02 14:34:44,351 — [INFO] Rows with target products: 4
2025-11-02 14:34:44,372 — [INFO] Removed rows with products: ['Data Analytics', 'Find yourself in IT']. Remaining rows: 19657
2025-11-02 14:34:44,398 — [INFO] Found 4970 duplicate rows for 2181 Contact Names.
2025-11-02 14:34:45,941 — [INFO] Removed 1017 empty duplicate rows where group has non-empty data.
2025-11-02 14:34:46,015 — [INFO] Removed 639 duplicate rows with empty key fields.
2025-11-02 14:34:46,084 — [INFO] Converted Created Time to datetime.
2025-11-02 14:34:46,096 — [INFO] Converted Closing Date to datetime.
2025-11-02 14:34:46,108 — [INFO] Rows where Created Time > Closing Date: 2245
2025-11-02 14:34:46,118 — [INFO] Swapped 2245 rows where Created Time was later than Closing Date.
2025-11-02 14:34:46,145 — [INFO] Found 0 negative Days_Diff values.
2025-11-02 14:34:46,166 — [INFO] Filled 11 missing Closing Date values.
2025-11-02 14:34:46,185 — [INFO] Temporary column Days_Diff removed after filling.
2025-11-02 14:34:46,201 — [INFO] Earliest 5 unique Created Time values:
<DatetimeArray>
['2022-10-11 00:00:00', '2023-07-01 00:00:00', '2023-07-03 00:00:00',
 '2023-07-03 20:17:00', '2023-07-03 20:39:00']
Length: 5, dtype: datetime64[ns]
2025-11-02 14:34:46,229 — [INFO] Removed 1 rows with Created Time = 2022-10-11 00:00:00
2025-11-02 14:34:46,289 — [INFO] File JSON updated and saved
2025-11-02 14:34:46,327 — [INFO] Normalized City names and applied 3 manual corrections.
2025-11-02 14:34:46,364 — [INFO] Added new columns (Federal state, Country, Latitude, Longitude)
2025-11-02 14:34:46,385 — [INFO] Cleaned and converted Initial Amount Paid — 13979 values changed.
2025-11-02 14:34:46,401 — [INFO] Cleaned and converted Offer Total Amount — 13965 values changed.
2025-11-02 14:34:46,415 — [INFO] Swapped 60 rows where Offer Total Amount < Initial Amount Paid.
2025-11-02 14:34:46,448 — [INFO] Payment Type counts after filling:
         Payment Type  Count
0  Recurring Payments  16639
1         No Payments    814
2         One Payment     58
3         Reservation     10
2025-11-02 14:34:46,452 — [INFO] Filled 17521 missing Payment Type values.
2025-11-02 14:34:46,528 — [INFO] Created new column German Level with normalized values.
2025-11-02 14:34:46,541 — [INFO] German Level distribution:
German Level
Unknown    16764
B1           824
B2           183
A2           152
C1            27
A1            27
A0            20
C2             3
Name: count, dtype: int64
2025-11-02 14:34:46,560 — [INFO] Removed original column Level of Deutsch.
2025-11-02 14:34:46,618 — [INFO] Unique values after transformation: ['Unknown' 'Non Target' 'Non Qualified' 'Medium' 'Low' 'High']
2025-11-02 14:34:46,792 — [INFO] Failed to convert: 3796 (21.09%)
2025-11-02 14:34:46,793 — [INFO] Converted successfully: 14204 rows (78.91%)
2025-11-02 14:34:46,796 — [INFO] Min SLA: 3.0, Max SLA: 26908464.0
2025-11-02 14:34:46,873 — [INFO] Failed to convert: 3796 (21.09%)
2025-11-02 14:34:46,874 — [INFO] Converted successfully: 14204 rows (78.91%)
2025-11-02 14:34:46,876 — [INFO] Min SLA: 0.05, Max SLA: 448474.4
2025-11-02 14:34:46,938 — [INFO] Failed to convert: 3796 (21.09%)
2025-11-02 14:34:46,939 — [INFO] Converted successfully: 14204 rows (78.91%)
2025-11-02 14:34:46,940 — [INFO] Min SLA: 0.0, Max SLA: 7474.57
2025-11-02 14:34:47,003 — [INFO] Filled missing values with Unknown.
2025-11-02 14:34:47,021 — [INFO] Filled missing and "-" values in City column with Unknown.
2025-11-02 14:34:47,033 — [INFO] Filled "_" values in Term column with Unknown.
2025-11-02 14:34:47,048 — [INFO] Converted 3513 non-null values.
2025-11-02 14:34:47,056 — [INFO] Converted 835 non-null values.
2025-11-02 14:34:47,063 — [INFO] Converted 4032 non-null values.
2025-11-02 14:34:47,071 — [INFO] Converted 4061 non-null values.
2025-11-02 14:34:47,083 — [INFO] Converted Stage to category.
2025-11-02 14:34:47,089 — [INFO] Converted Quality to category.
2025-11-02 14:34:47,094 — [INFO] Converted Source to category.
2025-11-02 14:34:47,099 — [INFO] Converted Product to category.
2025-11-02 14:34:47,104 — [INFO] Converted Lost Reason to category.
2025-11-02 14:34:47,110 — [INFO] Converted Education Type to category.
2025-11-02 14:34:47,115 — [INFO] Converted German Level to category.
2025-11-02 14:34:47,119 — [INFO] Converted Payment Type to category.
2025-11-02 14:34:47,282 — [INFO] ==================================================
2025-11-02 14:34:47,285 — [INFO] === Saving results ===
2025-11-02 14:34:47,285 — [INFO] ==================================================
2025-11-02 14:35:11,105 — [INFO] Cleaned dataset saved as data/clean/calls_clean.xlsx
2025-11-02 14:35:13,223 — [INFO] Cleaned dataset saved as data/clean/contacts_clean.xlsx
2025-11-02 14:35:25,389 — [INFO] Cleaned dataset saved as data/clean/deals_clean.xlsx
2025-11-02 14:35:27,979 — [INFO] Cleaned dataset saved as data/clean/spend_clean.xlsx
2025-11-02 14:35:29,452 — [INFO] Table saved as notebooks/figures/calls_info_raw.png
2025-11-02 14:35:31,055 — [INFO] Table saved as notebooks/figures/calls_info_clean.png
2025-11-02 14:35:31,706 — [INFO] Table saved as notebooks/figures/contacts_info_raw.png
2025-11-02 14:35:32,618 — [INFO] Table saved as notebooks/figures/contacts_info_clean.png
2025-11-02 14:35:34,371 — [INFO] Table saved as notebooks/figures/spend_info_raw.png
2025-11-02 14:35:35,612 — [INFO] Table saved as notebooks/figures/spend_info_clean.png
2025-11-02 14:35:40,291 — [INFO] Table saved as notebooks/figures/deals_info_raw.png
2025-11-02 14:35:47,961 — [INFO] Table saved as notebooks/figures/deals_info_clean.png
2025-11-02 14:35:48,038 — [INFO] Table saved as notebooks/figures/contacts_bool_rows.png
2025-11-02 14:35:48,403 — [INFO] Table saved as notebooks/figures/deals_earliest_rows.png
2025-11-02 14:35:48,936 — [INFO] Table saved as notebooks/figures/deals_missing_id.png
2025-11-02 14:35:48,938 — [INFO] All cleaned datasets and visualizations successfully saved in 61.65 sec.
